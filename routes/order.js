const _0x3537bc = _0x3450; (function (_0x128315, _0x4d2776) { const _0x3e859f = _0x3450, _0x13de5f = _0x128315(); while (!![]) { try { const _0x567ac7 = parseInt(_0x3e859f(0xc5)) / 0x1 + parseInt(_0x3e859f(0xf0)) / 0x2 + parseInt(_0x3e859f(0xdf)) / 0x3 + -parseInt(_0x3e859f(0xcf)) / 0x4 * (-parseInt(_0x3e859f(0xe3)) / 0x5) + parseInt(_0x3e859f(0xc4)) / 0x6 * (parseInt(_0x3e859f(0xde)) / 0x7) + -parseInt(_0x3e859f(0xcc)) / 0x8 + parseInt(_0x3e859f(0xec)) / 0x9 * (-parseInt(_0x3e859f(0xd6)) / 0xa); if (_0x567ac7 === _0x4d2776) break; else _0x13de5f['push'](_0x13de5f['shift']()); } catch (_0x2a7cac) { _0x13de5f['push'](_0x13de5f['shift']()); } } }(_0x5585, 0x23dee)); function _0x5585() { const _0x14af79 = ['time_period', 'rz_id', '49122MkHhIW', '146749qbjulr', 'Paypal', 'rz_key', 'paypal_client_secret', 'Server\x20error', 'body', 'Congo!', '926416CGWDAE', './order/orderfun', 'Something\x20went\x20wrong\x20with\x20yout\x20payment.\x20Please\x20try\x20again\x20or\x20contact\x20support\x20if\x20your\x20payment\x20deducted', '96rNnbkc', 'payments', 'status', '/get_all_orders_admin', 'COMPLETED', 'Razorpay', 'INR', '5280050XziOEw', 'moment', 'capture', 'razorpay', 'log', 'Something\x20went\x20wrong,\x20Try\x20again', 'add', 'post', '119XGSptw', '837459PXKxqB', 'access_token', 'https://api-m.sandbox.paypal.com/v1/checkout/orders/', 'SELECT\x20*\x20FROM\x20orders', '18520atobIs', 'rz_payment_id', 'node-fetch', 'plan', 'binary', '/paypal_with_paypal', 'exports', 'get', 'ordergen', '9WiNlbH', 'exchange_rate', 'bcrypt', 'updatemsg', '273512HXPsAg', 'https://api-m.sandbox.paypal.com/v1/oauth2/token', 'round', 'Router', 'json', 'GET', 'express', 'order_id', 'POST', 'days', 'getweb', 'grant_type=client_credentials', '/pay_with_rz', 'Order\x20id\x20and\x20plan\x20required']; _0x5585 = function () { return _0x14af79; }; return _0x5585(); } function _0x3450(_0x46fc1b, _0x340f4c) { const _0x55856e = _0x5585(); return _0x3450 = function (_0x3450cb, _0x252cb8) { _0x3450cb = _0x3450cb - 0xbc; let _0x35e3f6 = _0x55856e[_0x3450cb]; return _0x35e3f6; }, _0x3450(_0x46fc1b, _0x340f4c); } const router = require(_0x3537bc(0xf6))[_0x3537bc(0xf3)](), con = require('../config/config'), bcrypt = require(_0x3537bc(0xee)), { isvalid, isuser } = require('../middlewares/user'), moment = require(_0x3537bc(0xd7)), fetch = require(_0x3537bc(0xe5)), orderfun = require(_0x3537bc(0xcd)), Razorpay = require(_0x3537bc(0xd9)), randomstring = require('randomstring'); router[_0x3537bc(0xdd)](_0x3537bc(0xc0), isuser, async (_0x5c2b82, _0x394970) => { const _0x28a47b = _0x3537bc; try { const _0xffcbbc = _0x5c2b82[_0x28a47b(0xca)][_0x28a47b(0xe6)], _0x42c16 = await orderfun[_0x28a47b(0xbe)](), _0x1ecf64 = new Date(), _0x2f5936 = moment(_0x1ecf64)[_0x28a47b(0xdc)](_0xffcbbc[_0x28a47b(0xc2)], _0x28a47b(0xbd)); var _0x20a1ff = new Razorpay({ 'key_id': _0x42c16[_0x28a47b(0xc3)], 'key_secret': _0x42c16[_0x28a47b(0xc7)] }); const _0x16fc6f = parseInt(_0x5c2b82['body']['amount']) / parseInt(_0x42c16[_0x28a47b(0xed)]) * 0x50, _0x468cfc = await _0x20a1ff[_0x28a47b(0xd0)][_0x28a47b(0xd8)](_0x5c2b82[_0x28a47b(0xca)][_0x28a47b(0xe4)], Math[_0x28a47b(0xf2)](_0x16fc6f) * 0x64, _0x28a47b(0xd5)); if (!_0x468cfc) { _0x394970['json']({ 'success': ![], 'msg': _0x28a47b(0xdb) }); return; } const _0x4d75a6 = await orderfun[_0x28a47b(0xef)]({ 'req': _0x5c2b82, 'plan': _0xffcbbc }); await orderfun[_0x28a47b(0xeb)]({ 'req': _0x5c2b82, 'msgg': _0x468cfc, 'type': _0x28a47b(0xd4) }), _0x394970[_0x28a47b(0xf4)]({ 'success': !![], 'data': _0x4d75a6, 'msg': _0x28a47b(0xcb) }); } catch (_0x37e290) { console[_0x28a47b(0xda)](_0x37e290), _0x394970['json']({ 'msg': _0x28a47b(0xc9), 'err': _0x37e290 }); } }), router['post'](_0x3537bc(0xe8), isuser, async (_0x45207b, _0x1ea63e) => { const _0x3a0e90 = _0x3537bc; try { var _0x39008c = _0x45207b[_0x3a0e90(0xca)][_0x3a0e90(0xf7)]; const _0x316754 = _0x45207b[_0x3a0e90(0xca)][_0x3a0e90(0xe6)]; if (!_0x39008c || !_0x316754) return _0x1ea63e[_0x3a0e90(0xf4)]({ 'msg': _0x3a0e90(0xc1) }); const _0x1f6d2d = new Date(), _0x58d50b = moment(_0x1f6d2d)['add'](_0x316754['time_period'], _0x3a0e90(0xbd)), _0x5d5ada = await orderfun[_0x3a0e90(0xbe)](); let _0x52f86f = _0x5d5ada['paypal_client_id'], _0x389eb0 = _0x5d5ada[_0x3a0e90(0xc8)], _0xfa88e4 = await fetch(_0x3a0e90(0xf1), { 'method': _0x3a0e90(0xbc), 'body': _0x3a0e90(0xbf), 'headers': { 'Authorization': 'Basic\x20' + Buffer['from'](_0x52f86f + ':' + _0x389eb0, _0x3a0e90(0xe7))['toString']('base64') } }), _0x55c961 = await _0xfa88e4[_0x3a0e90(0xf4)](), _0x119c75 = await fetch(_0x3a0e90(0xe1) + _0x39008c, { 'method': _0x3a0e90(0xf5), 'headers': { 'Authorization': 'Bearer\x20' + _0x55c961[_0x3a0e90(0xe0)] } }), _0x4ce199 = await _0x119c75[_0x3a0e90(0xf4)](); if (!_0x4ce199[_0x3a0e90(0xd1)] === _0x3a0e90(0xd3)) { _0x1ea63e[_0x3a0e90(0xf4)]({ 'success': ![], 'msg': _0x3a0e90(0xce) }); return; } const _0x16a635 = await orderfun[_0x3a0e90(0xef)]({ 'req': _0x45207b, 'plan': _0x316754 }); var _0x42029d = _0x4ce199; await orderfun[_0x3a0e90(0xeb)]({ 'req': _0x45207b, 'msgg': _0x42029d, 'type': _0x3a0e90(0xc6) }), _0x1ea63e[_0x3a0e90(0xf4)]({ 'success': !![], 'data': _0x16a635, 'msg': _0x3a0e90(0xcb) }); } catch (_0x3dedef) { console['log'](_0x3dedef), _0x1ea63e['json']({ 'err': _0x3dedef, 'msg': 'Server\x20error' }); } }), router[_0x3537bc(0xea)](_0x3537bc(0xd2), isvalid, (_0x3b9702, _0x51c5bc) => { const _0x2d8ad8 = _0x3537bc; var _0x18633a = _0x2d8ad8(0xe2); con['query'](_0x18633a, (_0x1d4ae1, _0x513bfe) => { const _0x45d74e = _0x2d8ad8; if (_0x1d4ae1) { _0x51c5bc[_0x45d74e(0xf4)]({ 'msg': 'Db\x20query\x20error' }), console[_0x45d74e(0xda)](_0x1d4ae1); return; } else _0x51c5bc[_0x45d74e(0xf4)]({ 'success': !![], 'data': _0x513bfe }); }); }), module[_0x3537bc(0xe9)] = router;